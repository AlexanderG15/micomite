var parametroAjax={token:$("input[name=_token]").val(),tipo:"POST",data:{},ruta:"",async:false};var GuardarVotacion=function(){parametroAjax.data=$("#FormVotacion").serialize();
parametroAjax.ruta=rutaV;respuesta=procesarajax(parametroAjax);ManejoRespuestaProcesar(respuesta);};var ManejoRespuestaProcesar=function(a){switch(a.code){case"200":$(".cerrar").modal("hide");
$(".comentarios").val("");$(".id_proveedor").val("");mensajesAlerta("Procesado!","Registro éxitoso","info");location.reload("");break;default:mensajesAlerta("Error","Se ha encontrado un error comunicarse con el personal informático","error");
}};var validarVotacion=function(){$("#FormVotacion").formValidation("validate");};$(function(){var a={init:function(){$("#portfoliolist").mixItUp({selectors:{target:".portfolio",filter:".filter"},load:{filter:".principal"}});
}};a.init();});var __slice=[].slice;(function(c,b){var a;a=(function(){d.prototype.defaults={rating:void 0,numStars:5,change:function(g,f){}};function d(h,f){var g,e,j,k=this;
this.options=c.extend({},this.defaults,f);this.$el=h;j=this.defaults;for(g in j){e=j[g];if(this.$el.data(g)!=null){this.options[g]=this.$el.data(g);}}this.createStars();
this.syncRating();this.$el.on("mouseover.starrr","span",function(i){return k.syncRating(k.$el.find("span").index(i.currentTarget)+1);});this.$el.on("mouseout.starrr",function(){return k.syncRating();
});this.$el.on("click.starrr","span",function(i){return k.setRating(k.$el.find("span").index(i.currentTarget)+1);});this.$el.on("starrr:change",this.options.change);
}d.prototype.createStars=function(){var g,f,e;e=[];for(g=1,f=this.options.numStars;1<=f?g<=f:g>=f;1<=f?g++:g--){e.push(this.$el.append("<span class='glyphicon .glyphicon-star-empty'></span>"));
}return e;};d.prototype.setRating=function(e){c(".estrellas").val(e);c("#count").text(e);if(this.options.rating===e){e=void 0;}this.options.rating=e;this.syncRating();
return this.$el.trigger("starrr:change",e);};d.prototype.syncRating=function(f){var e,j,g,h;f||(f=this.options.rating);if(f){for(e=j=0,h=f-1;0<=h?j<=h:j>=h;
e=0<=h?++j:--j){this.$el.find("span").eq(e).removeClass("glyphicon-star-empty").addClass("glyphicon-star");}}if(f&&f<5){for(e=g=f;f<=4?g<=4:g>=4;e=f<=4?++g:--g){this.$el.find("span").eq(e).removeClass("glyphicon-star").addClass("glyphicon-star-empty");
}}if(!f){return this.$el.find("span").removeClass("glyphicon-star").addClass("glyphicon-star-empty");}};return d;})();return c.fn.extend({starrr:function(){var d,e;
e=arguments[0],d=2<=arguments.length?__slice.call(arguments,1):[];return this.each(function(){var f;f=c(this).data("star-rating");if(!f){c(this).data("star-rating",(f=new a(c(this),e)));
}if(typeof e==="string"){return f[e].apply(f,d);}});}});})(window.jQuery,window);$(function(){return $(".starrr").starrr();});var mostrarVotacion=function(){var a=$(this).attr("value");
$(".id_proveedor").val(a);};var volverVotacion=function(){};var capturaComentario=function(){var a=$(this).val();$(".comentarios").val(a);};var asignarProveedorId=function(){var a=$(this).val();
$(".id_proveedor").val(a);};var mostrarVotacion=function(){var a=$(this).attr("value");parametroAjax.data={id_proveedor:a};parametroAjax.ruta=rutaC;respuesta=procesarajax(parametroAjax);
verComentariosModal(respuesta);};var verComentariosModal=function(a){switch(a.code){case"200":abrirModalComentarios(a);break;default:mensajesAlerta("Error","Se ha encontrado un error comunicarse con el personal informático","error");
}};var abrirModalComentarios=function(b){$("#divComentarios").empty();$("#tituloProveedor").text("");$("#myModalComentarios").window("open");var c=b.respuesta;
var a=$("#divComentarios");$("#tituloProveedor").text(c[0].proveedor);$(c).each(function(){var g=this.votacion;var d="";var f="/img/foto.jpeg";if(this.foto_usuario!=null){f=this.foto_usuario;
}for(var e=0;e<5;e++){if(e<g){d+="<a href='#'>&#9733;</a>";}else{d+="<a href='#' style='color: #95a5a6;display: inline-block; font-size: 23px;' >&#9733;</a>";
}}$(a).append('<div class="row"><div class="col-md-12 fichaComentario"><table width="100%" border="0"><tr><td colspan="2" width="40%"><h3><b><center>'+this.des_sede+'</center></b></h3></td><td rowspan="2" width="60%">'+this.comentario+'</td></tr><tr><td><br><img src="'+f+'" class="img-circle" width="60"></td><td><br><table class="table" width="100%" border="0"><tr></tr><tr><h4>'+this.usuario+"</h4></tr><tr>Fecha: <i>"+this.fecha_publicacion+'</i></tr><tr></tr><tr><div><div class="star-rating">'+d+"</div></div></tr></table></td></tr></table></div></div><br>");
});};var cargarTablaComentarios=function(a){$("#tablaComentarios").dataTable({paging:false,searching:false,info:false,columnDefs:[{targets:-1,data:null,targets:[1],searchable:true,}],language:{url:"/DataTables-1.10.10/de_DE-all.txt"},data:a,columns:[{title:"Id",data:"id_opcion",visible:0},{puntuacion:"Opción",data:"titulo"},{title:"Opción",data:"titulo"},{title:"Opción",data:"titulo"},],});
};var ocultarBanner=function(){$("#principal").hide();};$(document).ready(function(){$(document).on("click","#guardarV",validarVotacion);$(document).on("click",".evaluaciones",mostrarVotacion);
$(document).on("click",".parametro",asignarProveedorId);$(document).on("click","#cancelar",volverVotacion);$(document).on("change","#comentariost",capturaComentario);
$(document).on("click",".filter",ocultarBanner);$("#FormVotacion").formValidation({fields:{comentarios:{verbose:false,validators:{notEmpty:{message:"El campo es requerido."},}},}}).on("success.form.fv",function(a){GuardarVotacion();
}).on("status.field.fv",function(b,a){a.element.parents(".form-group").removeClass("has-success");});});
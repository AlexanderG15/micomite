var Registrocartelera="";var id_usuario_cartelera=0;var parametroAjax={token:$("input[name=_token]").val(),tipo:"POST",data:{},ruta:"",async:false};var pintarDatosActualizar=function(a){if(a.id_cartelera!=null){$("#id_cartelera").val(a.id_cartelera);
}if(a.descripcion!=null){$("#descripcion").val(a.descripcion);}if(a.titulo!=null){$("#titulo").val(a.titulo);}if(!a.prioridad){$("#prioridadB").attr("checked",true);
$("#prioridadA").attr("checked",false);}else{$("#prioridadA").attr("checked",true);$("#prioridadB").attr("checked",false);}if(!a.estatus){$("#estatus").prop("checked",false);
}else{$("#estatus").prop("checked",true);}if(a.fecha!=null){$("#fecha").val(moment(a.fecha).format("DD/MM/YYYY"));}};var cargarTablaCartelera=function(a){$("#tablaCarteleras").dataTable({paging:true,searching:true,info:false,order:[],columnDefs:[{orderable:false,targets:[0,1,2,3,4]},],displayLength:20,language:{url:"/DataTables-1.10.10/de_DE-all.txt"},data:a,columns:[{title:"Id Cartelera",data:"id_cartelera",visible:0},{title:"Fecha",data:"fecha_formato",width:"10%"},{title:"Usuario",data:"nombre_usuario",width:"20%"},{title:"Aviso",data:"titulo",width:"60%"},{title:"Prioridad",data:"des_prioridad",width:"10%"},{title:"estatus",data:"estatus",visible:0},],fnCreatedRow:function(e,c,b){if(c.id_usuario_cartelera==null){$(e).css("background","#FFFD9F");
}},});};var cargarForm=function(){$("#divTabla").hide();$("#divForm").show();$("#divGuardar").show();$("#id_cartelera").val("");$("#titulo").attr("readonly",false);
$("#descripcion").attr("readonly",false);$("#FormCartelera")[0].reset();$(".comboclear").val("").trigger("change");};var volver=function(){$("#divTabla").show();
$("#divForm").hide();if(id_usuario_cartelera==0){parametroAjax.ruta=rutaA;parametroAjax.data=Registrocartelera;respuesta=procesarajax(parametroAjax);ManejoRespuesta(respuesta);
}};var ProcesarCartelera=function(){var f=$("#id_cartelera").val();var c=$("#descripcion").val();var b=$("#titulo").val();var a=false;var e=true;if($("#estatus").is(":checked")){a=true;
}if($("input[name=prioridad]:checked","#FormCartelera").val()=="1"){e=false;}datos=[];datos={id_cartelera:f,descripcion:c,prioridad:e,estatus:a,titulo:b};
parametroAjax.ruta=ruta;parametroAjax.data=datos;respuesta=procesarajax(parametroAjax);ManejoRespuestaProcesar(respuesta);};var ManejoRespuestaProcesar=function(c){if(c.code=200){var b=JSON.parse(c.respuesta.f_registro_carteleras[0].f_registro_carteleras);
switch(b.code){case"200":var a=JSON.parse(c.respuesta.v_carteleras);destruirTablaS("tablaCarteleras");cargarTablaCartelera(a);mensajesAlerta("Procesado!",b.des_code,"info");
$("#id_cartelera").val(b.id_cartelera);$("#divForm").hide();$("#divTabla").show();break;case"-2":mensajesAlerta("Error",b.des_code,"error");break;default:mensajesAlerta("Error","Comuniquese con el personal de sopore t√©cnico","error");
}}else{mensajesAlerta("Error","Ocurrio un error al eliminar las imagenes","error");}};var verCartelera=function(a){if(a.id_usuario_cartelera!=null){id_usuario_cartelera=a.id_usuario_cartelera;
}else{id_usuario_cartelera=0;}$("#divGuardar").hide();$("#descripcion").val(a.descripcion);$("#titulo").val(a.titulo);$("#fecha").text(a.fecha_formato);
$("#divTabla").hide();$("#divTitulo").hide();$("#divForm").show();$("#descripcion").attr("readonly",true);$("#titulo").attr("readonly",true);};var ManejoRespuesta=function(a){if(a.code=200){destruirTablaS("tablaCarteleras");
cargarTablaCartelera(a.respuesta);}else{mensajesAlerta("Error","Ocurrio un error al eliminar las imagenes","error");}};var validarC=function(){$("#FormCartelera").formValidation("validate");
};$(document).ready(function(){if(d.id_nivel==2){$("#divPrioridad").show();}if(d.id_nivel==3){$("#divPrioridad").hide();}$(document).on("click","#guardar",validarC);
$(document).on("click","#agregar",cargarForm);$(document).on("click","#cancelar",volver);$("#prioridadB").attr("checked",true);$("#tituloPantalla").text(d.title);
cargarTablaCartelera(d.v_carteleras_activas);$("input[name=prioridad]:checked","#FormCartelera").val();var a=$("#tablaCarteleras").dataTable();$("#tablaCarteleras tbody").on("click","tr",function(b){a.$("tr.selected").removeClass("selected");
$(this).addClass("selected");Registrocartelera=TablaTraerCampo("tablaCarteleras",this);verCartelera(Registrocartelera);});a.on("dblclick","tr",function(){$("#close").trigger("click");
});$("#FormCartelera").formValidation({fields:{descripcion:{verbose:false,validators:{notEmpty:{message:"El campo es requerido."},}},titulo:{verbose:false,validators:{notEmpty:{message:"El campo es requerido."},}}}}).on("success.form.fv",function(b){ProcesarCartelera();
}).on("status.field.fv",function(c,b){b.element.parents(".form-group").removeClass("has-success");});});